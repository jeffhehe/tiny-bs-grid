/*
 *	tiny-bs-grid https://github.com/jeffhehe/tiny-bs-grid
 *  this works for TinyMCE5.* on Bootstrap 3.*
 *  Version: v0.4
 *  Author: Jeff Wang
 *  Date: Jan 20, 2023
 */
tinymce.PluginManager.add("bootstrap3grid",function e(t,s){t.contentCSS.push(s+"/bootstrapgrid-style.css"),t.ui.registry.addToggleButton("bootstrap3grid",{text:"BS3 Grid",tooltip:"Bootstrap3 Grid System",onAction:function e(){var s="Insert Bootstrap3 Grids",l=["12"],a="md",o=jQuery(t.selection.getNode()).parents("div.row"),n=o.length>0;if(n){var r=jQuery(o[0]).children("div"),p=r.length,d=[];if(p>0)for(i=0,l=[];i<p;i++){var v=jQuery(r[i]).attr("class").split(/\s+/),u=jQuery(r[i]).html();for(d.push(u),j=0;j<v.length;j++)if(/^col-.*/i.test(v[j])){0==j&&(v[0].indexOf("col-lg")>-1?a="lg":v[0].indexOf("col-sm")>-1?a="sm":v[0].indexOf("col-xs")>-1&&(a="xs"));var c=v[j].lastIndexOf("-"),m=v[j].substr(c+1);l.push(m)}}s="Update/Remove Bootstrap3 Grids"}var x=[{type:"selectbox",name:"size",label:"Target Screen",items:[{text:"Large => 1200px",value:"lg"},{text:"Medium => 992px",value:"md"},{text:"Small => 768px",value:"sm"},{text:"X Small < 768px",value:"xs"},]},{type:"selectbox",name:"grid",label:"Grid",items:[{text:"1 Column",value:"12"},{text:"2 Columns (1:1)",value:"6,6"},{text:"2 Columns (2:1)",value:"8,4"},{text:"2 Columns (3:1)",value:"9,3"},{text:"2 Columns (1:2)",value:"4,8"},{text:"2 Columns (1:3)",value:"3,9"},{text:"3 Columns (1:1:1)",value:"4,4,4"},{text:"3 Columns (2:1:1)",value:"6,3,3"},{text:"3 Columns (1:2:1)",value:"3,6,3"},{text:"3 Columns (1:1:2)",value:"3,3,6"},{text:"4 Columns (1:1:1:1)",value:"3,3,3,3"}]},{type:"checkbox",name:"leadingBreak",label:"Add a Leading Line Break"}],b={type:"panel",items:x};n&&(b={type:"tabpanel",tabs:[{title:"Update Bootstrap Grids",items:x},{title:"Remove Bootstrap Grids",items:[{type:"checkbox",name:"removeGrids",label:"Remove Bootstrap Grids"}]}]}),t.windowManager.open({title:s,body:b,initialData:{size:a,grid:l.toString()},buttons:[{type:"submit",name:"submitBtn",text:"Submit"},{type:"cancel",name:"cancelBtn",text:"Cancel"}],onSubmit:function(e){var s=e.getData(),l="",a="",r="<p>&nbsp;</p>";if(!0==s.leadingBreak&&(l="<p>&nbsp;</p>"),!0==s.removeGrids&&n){a=d.join("<p>&nbsp;</p>"),jQuery(o).replaceWith(l+a+r),e.close();return}(function(e){let t=e.length;if(n){if(p>0&&p<t){for(var l=0;l<p;l++)a+='<div class="col-'+s.size+"-"+e[l]+'">'+d.shift()+"</div>";for(var o=p;o<t;o++)a+='<div class="col-'+s.size+"-"+e[o]+'"><p>&nbsp;</p></div>'}else if(p>=t){for(var l=0;l<t;l++)a+='<div class="col-'+s.size+"-"+e[l]+'">'+d.shift()+"</div>";p>t&&(r="<p>&nbsp;</p><div>"+d.join("<p>&nbsp;</p>")+"</div><p>&nbsp;</p>")}}else for(var v=0;v<t;v++)a+='<div class="col-'+s.size+"-"+e[v]+'"><p>&nbsp;</p></div>'})(s.grid.split(",")),n?jQuery(o).replaceWith(l+'<div class="row">'+a+"</div>"+r):t.insertContent(l+'<div class="row">'+a+"</div>"+r),e.close()}})},onSetup:function(e){t.selection.selectorChanged("div.row",function(t){e.setActive(t)})}})});