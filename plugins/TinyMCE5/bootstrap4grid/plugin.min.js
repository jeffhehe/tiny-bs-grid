/*
 *	tiny-bs-grid https://github.com/jeffhehe/tiny-bs-grid
 *  this works for TinyMCE5.* on Bootstrap 4.*
 *  Version: v0.4
 *  Author: Jeff Wang
 *  Date: Jan 20, 2023
 */
tinymce.PluginManager.add("bootstrap4grid",function e(t,l){t.contentCSS.push(l+"/bootstrapgrid-style.css"),t.ui.registry.addToggleButton("bootstrap4grid",{text:"BS4 Grid",tooltip:"Bootstrap4 Grid System",onAction:function e(){var l="Insert Bootstrap4 Grids",s=["12"],a="-md",o=jQuery(t.selection.getNode()).parents("div.row"),n=o.length>0;if(n){var r=jQuery(o[0]).children("div"),p=r.length,d=[];if(p>0)for(i=0,s=[];i<p;i++){var u=jQuery(r[i]).attr("class").split(/\s+/),v=jQuery(r[i]).html();for(d.push(v),j=0;j<u.length;j++)if(/^col-.*/i.test(u[j])){0==j&&(a=u[0].indexOf("col-xl")>-1?"-xl":u[0].indexOf("col-lg")>-1?"-lg":u[0].indexOf("col-md")>-1?"-md":u[0].indexOf("col-sm")>-1?"-sm":"");var c=u[j].lastIndexOf("-"),m=u[j].substr(c+1);s.push(m)}}l="Update/Remove Bootstrap4 Grids"}var x=[{type:"selectbox",name:"size",label:"Target Screen",items:[{text:"X Large >= 1200px",value:"-xl"},{text:"Large >= 992px",value:"-lg"},{text:"Medium >= 768px",value:"-md"},{text:"Small >= 576px",value:"-sm"},{text:"X Small < 576px",value:""},]},{type:"selectbox",name:"grid",label:"Grid",items:[{text:"1 Column",value:"12"},{text:"2 Columns (1:1)",value:"6,6"},{text:"2 Columns (2:1)",value:"8,4"},{text:"2 Columns (3:1)",value:"9,3"},{text:"2 Columns (1:2)",value:"4,8"},{text:"2 Columns (1:3)",value:"3,9"},{text:"3 Columns (1:1:1)",value:"4,4,4"},{text:"3 Columns (2:1:1)",value:"6,3,3"},{text:"3 Columns (1:2:1)",value:"3,6,3"},{text:"3 Columns (1:1:2)",value:"3,3,6"},{text:"4 Columns (1:1:1:1)",value:"3,3,3,3"}]},{type:"checkbox",name:"leadingBreak",label:"Add a Leading Line Break"}],g={type:"panel",items:x};n&&(g={type:"tabpanel",tabs:[{title:"Update Bootstrap Grids",items:x},{title:"Remove Bootstrap Grids",items:[{type:"checkbox",name:"removeGrids",label:"Remove Bootstrap Grids"}]}]}),t.windowManager.open({title:l,body:g,initialData:{size:a,grid:s.toString()},buttons:[{type:"submit",name:"submitBtn",text:"Submit"},{type:"cancel",name:"cancelBtn",text:"Cancel"}],onSubmit:function(e){var l=e.getData(),s="",a="",r="<p>&nbsp;</p>";if(!0==l.leadingBreak&&(s="<p>&nbsp;</p>"),!0==l.removeGrids&&n){a=d.join("<p>&nbsp;</p>"),jQuery(o).replaceWith(s+a+r),e.close();return}(function(e){let t=e.length;if(n){if(p>0&&p<t){for(var s=0;s<p;s++)a+='<div class="col'+l.size+"-"+e[s]+'">'+d.shift()+"</div>";for(var o=p;o<t;o++)a+='<div class="col'+l.size+"-"+e[o]+'"><p>&nbsp;</p></div>'}else if(p>=t){for(var s=0;s<t;s++)a+='<div class="col'+l.size+"-"+e[s]+'">'+d.shift()+"</div>";p>t&&(r="<p>&nbsp;</p>"+d.join("<p>&nbsp;</p>")+"<p>&nbsp;</p>")}}else for(var u=0;u<t;u++)a+='<div class="col'+l.size+"-"+e[u]+'"><p>&nbsp;</p></div>'})(l.grid.split(",")),n?jQuery(o).replaceWith(s+'<div class="row">'+a+"</div>"+r):t.insertContent(s+'<div class="row">'+a+"</div>"+r),e.close()}})},onSetup:function(e){t.selection.selectorChanged("div.row",function(t){e.setActive(t)})}})});